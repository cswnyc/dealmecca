<!DOCTYPE html>
<html>
<head>
    <title>DealMecca Admin Contacts Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .contact-card { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 6px; background: #fafafa; }
        .contact-name { font-size: 18px; font-weight: bold; color: #333; }
        .contact-title { color: #666; margin: 5px 0; }
        .contact-company { color: #0066cc; font-weight: 500; }
        .quality-badge { display: inline-block; padding: 3px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; margin-left: 10px; }
        .quality-basic { background: #fef3c7; color: #92400e; }
        .quality-verified { background: #d1fae5; color: #065f46; }
        .quality-premium { background: #dbeafe; color: #1e40af; }
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { color: #333; margin-bottom: 10px; }
        .header p { color: #666; }
        .loading { text-align: center; padding: 40px; color: #666; }
        .error { background: #fee2e2; color: #991b1b; padding: 15px; border-radius: 6px; margin: 20px 0; }
        .success { background: #dcfce7; color: #166534; padding: 15px; border-radius: 6px; margin: 20px 0; }
        .stats { display: flex; gap: 20px; margin-bottom: 20px; }
        .stat { background: #f3f4f6; padding: 15px; border-radius: 6px; text-align: center; flex: 1; }
        .stat-number { font-size: 24px; font-weight: bold; color: #1f2937; }
        .stat-label { color: #6b7280; font-size: 14px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ DealMecca Admin Contacts Test</h1>
            <p>Testing if BASIC quality contacts are visible in the admin interface</p>
        </div>
        
        <div id="status" class="loading">Loading contacts...</div>
        <div id="stats" style="display: none;"></div>
        <div id="contacts"></div>
    </div>

    <script>
        async function loadContacts() {
            try {
                const response = await fetch('/api/admin/contacts?limit=20');
                const data = await response.json();
                
                if (data.success && data.data && data.data.contacts) {
                    const contacts = data.data.contacts;
                    displayContacts(contacts);
                    displayStats(contacts);
                } else {
                    document.getElementById('status').innerHTML = 
                        '<div class="error">‚ùå API returned no contacts: ' + JSON.stringify(data) + '</div>';
                }
            } catch (error) {
                document.getElementById('status').innerHTML = 
                    '<div class="error">‚ùå Failed to load contacts: ' + error.message + '</div>';
            }
        }

        function displayStats(contacts) {
            const basicCount = contacts.filter(c => c.dataQuality === 'BASIC').length;
            const verifiedCount = contacts.filter(c => c.dataQuality === 'VERIFIED').length;
            const premiumCount = contacts.filter(c => c.dataQuality === 'PREMIUM').length;
            
            document.getElementById('stats').innerHTML = `
                <div class="stat">
                    <div class="stat-number">${contacts.length}</div>
                    <div class="stat-label">Total Contacts</div>
                </div>
                <div class="stat">
                    <div class="stat-number">${basicCount}</div>
                    <div class="stat-label">BASIC Quality</div>
                </div>
                <div class="stat">
                    <div class="stat-number">${verifiedCount}</div>
                    <div class="stat-label">VERIFIED Quality</div>
                </div>
                <div class="stat">
                    <div class="stat-number">${premiumCount}</div>
                    <div class="stat-label">PREMIUM Quality</div>
                </div>
            `;
            document.getElementById('stats').style.display = 'flex';
        }

        function displayContacts(contacts) {
            const qualityClass = {
                'BASIC': 'quality-basic',
                'VERIFIED': 'quality-verified', 
                'PREMIUM': 'quality-premium',
                'EXPERT_VERIFIED': 'quality-premium'
            };

            const contactsHtml = contacts.map(contact => `
                <div class="contact-card">
                    <div class="contact-name">
                        ${contact.fullName || contact.firstName + ' ' + contact.lastName}
                        <span class="quality-badge ${qualityClass[contact.dataQuality] || 'quality-basic'}">
                            ${contact.dataQuality}
                        </span>
                    </div>
                    <div class="contact-title">${contact.title}</div>
                    <div class="contact-company">${contact.company ? contact.company.name : 'Unknown Company'}</div>
                    <div style="font-size: 12px; color: #888; margin-top: 8px;">
                        üìß ${contact.email || 'No email'} | 
                        üìû ${contact.phone || 'No phone'} | 
                        ${contact.verified ? '‚úÖ Verified' : '‚ö†Ô∏è Unverified'} |
                        ${contact.isActive ? 'üü¢ Active' : 'üî¥ Inactive'}
                    </div>
                </div>
            `).join('');

            document.getElementById('status').innerHTML = 
                '<div class="success">‚úÖ Successfully loaded ' + contacts.length + ' contacts (including BASIC quality)</div>';
            document.getElementById('contacts').innerHTML = contactsHtml;
        }

        // Auto-load on page load
        loadContacts();
    </script>
</body>
</html>
